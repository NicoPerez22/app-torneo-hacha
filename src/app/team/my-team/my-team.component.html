<!-- Header visual -->
<section class="position-relative min-vh-25 bg-black">
  <!-- Fondo visible solo en md+ -->
  <img
    src="../../../assets/images/fondo1.png"
    alt="Header"
    class="d-none d-md-block position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
  />
</section>

<!-- Secci贸n principal -->
<section class="position-relative py-5">
  <!-- Fondo para que el blur tenga efecto -->
  <img
    src="../../../assets/images/fondo1.png"
    alt=""
    class="d-none d-md-block position-absolute top-0 start-0 w-100 h-100 object-fit-cover opacity-25 z-n1"
  />

  <div class="container position-relative">
    <!-- Encabezado equipo -->
    <div class="row justify-content-center">
      <div class="col-12 col-md-8 text-center position-relative mb-4">
        <!-- Logo centrado -->
        <div class="position-absolute top-0 start-50 translate-middle z-1">
          <img
            [src]="myTeam?.logo?.secureUrl"
            alt="Logo equipo"
            width="70"
            height="70"
            class="object-fit-contain"
          />
        </div>

        <div class="pt-5 mt-4">
          <h2 class="text-white fw-bold mb-1">{{ myTeam?.name }}</h2>
          <ul class="d-flex justify-content-center gap-2 list-unstyled mb-3">
            <li><h6 class="text-white-50 mb-0">Manager:</h6></li>
            <li>
              <h6 class="text-white mb-0">
                {{ myTeam?.owner?.name }} {{ myTeam?.owner?.lastName }}
              </h6>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <nz-tabset nzCentered style="color: white">
      <nz-tab nzTitle="Jugadores">
        <div
          class="row row-cols-2 row-cols-sm-3 row-cols-md-3 row-cols-lg-6 g-3 mb-5"
        >
          <div class="col" *ngFor="let player of playersTeamsList">
            <!-- Card glass -->
            <div
              class="glass p-3 position-relative text-center h-100 text-white"
            >
              <!-- Acci贸n (cambiar) -->
              <ng-container
                *ngIf="!player.loading && user.id === myTeam?.owner?.id"
              >
                <button
                  type="button"
                  class="btn btn-sm btn-outline-light position-absolute top-0 end-0 m-2"
                  (click)="onChangePlayer(player)"
                >
                  <i class="fa fa-exchange"></i>
                </button>
              </ng-container>

              <!-- Spinner -->
              <ng-container *ngIf="player.loading">
                <div class="position-absolute top-0 end-0 m-2">
                  <div class="spinner-border spinner-border-sm text-info"></div>
                </div>
              </ng-container>

              <!-- Foto -->
              <img
                [src]="
                  player?.photo
                    ? player.photo.secureUrl
                    : '../../../assets/images/player-default.png'
                "
                alt="Jugador"
                width="60"
                height="60"
                class="rounded object-fit-cover mb-2"
              />

              <!-- Estado -->
              <div class="mb-1">
                <span
                  class="badge w-50"
                  [ngClass]="player.isHabilitado ? 'bg-success' : 'bg-danger'"
                >
                  {{ player.isHabilitado ? 'Habilitado' : 'Inhabilitado' }}
                </span>
              </div>

              <!-- Nombre -->
              <h6 class="mb-1 text-white">
                {{ player?.name }} {{ player?.lastName }}
              </h6>

              <!-- Posici贸n + valoraci贸n -->
              <div>
                <span
                  class="badge me-1"
                  [ngClass]="{
                    'text-bg-danger': player?.position == 'POR',
                    'text-bg-warning': ['LD', 'DFC', 'LI'].includes(
                      player?.position
                    ),
                    'text-bg-success': [
                      'MCO',
                      'MCD',
                      'MC',
                      'MI',
                      'MD'
                    ].includes(player?.position),
                    'text-bg-primary': ['DC', 'ED', 'EI'].includes(
                      player?.position
                    )
                  }"
                >
                  {{ player?.position }}
                </span>
                <span
                  class="badge text-white"
                  [ngClass]="{
                    'text-bg-warning': player?.valoration < 70,
                    'bg-success-subtle':
                      player?.valoration >= 70 && player?.valoration < 85,
                    'text-bg-success': player?.valoration >= 85
                  }"
                >
                  {{ player?.valoration }}
                </span>
              </div>

              <!-- Transferencia -->
              <div *ngIf="player?.isTransfer" class="mt-2">
                <span class="badge text-bg-info">En transferencias</span>
              </div>
            </div>
          </div>
        </div>
      </nz-tab>

      <nz-tab nzTitle="Proximas Fechas">
        <div class="text-center py-4">
          <div class="row justify-content-center">
            <div class="col-12 col-md-8 col-lg-7">
              <ul class="list-group list-group-flush">
                <li
                  class="list-group-item bg-dark text-white d-flex align-items-center justify-content-between rounded-3 my-2"
                  *ngFor="
                    let match of myTeam?.rounds
                      | paginate : { itemsPerPage: 6, currentPage: p }
                  "
                >
                  <!-- Local -->
                  <div class="d-flex align-items-center gap-2">
                    <img
                      [src]="
                        match?.homeLogo?.secureUrl
                          ? match?.homeLogo?.secureUrl
                          : '../../../assets/images/player-default.png'
                      "
                      alt="Logo local"
                      width="28"
                      height="30"
                      class="object-fit-contain"
                    />
                    <span class="fw-semibold">{{ match.home }}</span>
                  </div>

                  <div class="text-white-50 fw-bold">VS</div>

                  <!-- Visitante -->
                  <div class="d-flex align-items-center gap-2">
                    <span class="fw-semibold">{{ match.away }}</span>
                    <img
                      [src]="
                        match?.awayLogo?.secureUrl
                          ? match?.awayLogo?.secureUrl
                          : '../../../assets/images/player-default.png'
                      "
                      alt="Logo visitante"
                      width="28"
                      height="30"
                      class="object-fit-contain"
                    />
                  </div>
                </li>
              </ul>

              <div class="mt-4">
                <pagination-controls
                  (pageChange)="p = $event"
                  previousLabel="Anterior"
                  nextLabel="Siguiente"
                ></pagination-controls>
              </div>
            </div>
          </div>
        </div>
      </nz-tab>
    </nz-tabset>
  </div>
</section>
