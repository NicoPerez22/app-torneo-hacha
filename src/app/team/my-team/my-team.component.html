<div class="container">
  <div class="tournament-header">
    <div class="header-content">
      <div class="col-12 col-md-8 team-header-col">
        <div class="team-logo-wrap">
          <img
            [src]="myTeam?.logo?.secureUrl"
            alt="Logo equipo"
            width="70"
            height="70"
            class="team-logo-img"
          />
        </div>

        <div class="team-info">
          <h2 class="team-name">{{ myTeam?.name }}</h2>
          <ul class="team-manager-list">
            <li><h6 class="team-manager-label">Manager:</h6></li>
            <li>
              <h6 class="team-manager-name">
                {{ myTeam?.owner?.name }} {{ myTeam?.owner?.lastName }}
              </h6>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-3">
    <div class="col-12 col-lg-12">
      <div class="table-card">
        <div class="table-wrapper">
          <div class="p-3">
            <div class="row justify-content-center">

            </div>
            <div class="tabs-container">
              <nz-tabset nzCentered style="color: white">
                <nz-tab nzTitle="Jugadores">
                  <div class="players-grid-compact">
                    <div class="player-card-compact" *ngFor="let player of playersTeamsList">
                      <div class="player-card-compact-inner">
                        <div class="card-glow-compact"></div>

                        <ng-container
                          *ngIf="!player.loading && user.id === myTeam?.owner?.id"
                        >
                          <button
                            type="button"
                            class="btn-exchange"
                            (click)="onChangePlayer(player)"
                          >
                            <i class="fa fa-exchange"></i>
                          </button>
                        </ng-container>

                      <!-- <ng-container
                        *ngIf="!player.loading && user.id !== myTeam?.owner?.id"
                      >
                        <button
                          type="button"
                          class="btn-exchange"
                          (click)="onChangePlayer(player)"
                        >
                          <i class="fa fa-dollar"></i>
                        </button>
                      </ng-container> -->

                        <ng-container *ngIf="player.loading">
                          <div class="spinner-container">
                            <div class="spinner-border spinner-border-sm text-info"></div>
                          </div>
                        </ng-container>

                        <div class="player-photo-compact">
                          <img
                            [src]="
                              player?.photo?.secureUrl
                                ? player.photo.secureUrl
                                : '../../../assets/images/player-default.png'
                            "
                            [alt]="player?.name + ' ' + player?.lastName"
                            class="player-image"
                          />
                        </div>

                        <div class="player-status">
                          <span
                            class="status-badge-compact"
                            [ngClass]="player.isHabilitado ? 'status-enabled' : 'status-disabled'"
                          >
                            {{ player.isHabilitado ? 'Activo' : 'Inactivo' }}
                          </span>
                        </div>

                        <h6 class="player-name-compact">
                          {{ player?.name }} {{ player?.lastName }}
                        </h6>

                        <div class="player-stats-compact">
                          <span
                            class="position-badge-compact"
                            [ngClass]="{
                              'pos-gk': player?.position == 'POR',
                              'pos-defence': ['LD', 'DFC', 'LI'].includes(player?.position),
                              'pos-midfield': ['MCO', 'MCD', 'MC', 'MI', 'MD'].includes(player?.position),
                              'pos-attack': ['DC', 'ED', 'EI'].includes(player?.position)
                            }"
                          >
                            {{ player?.position }}
                          </span>
                          <span
                            class="rating-badge-compact"
                            [ngClass]="{
                              'rating-low': player?.valoration < 70,
                              'rating-medium': player?.valoration >= 70 && player?.valoration < 85,
                              'rating-high': player?.valoration >= 85
                            }"
                          >
                            {{ player?.valoration }}
                          </span>
                        </div>

                        <div *ngIf="player?.isTransfer" class="transfer-badge-compact">
                          <span class="badge-transfer">En transferencias</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </nz-tab>

                <nz-tab nzTitle="Proximas Fechas">
                  <div class="fixtures-container">
                    <div class="group-card">
                      <ul class="matches-list">
                        <li
                          class="match-item"
                          *ngFor="
                            let match of (myTeam?.rounds || [])
                              | paginate: { id: 'my-team-rounds', itemsPerPage: roundsPerPage, currentPage: p }
                          "
                        >
                          <div class="team left">
                            <img [src]="match?.homeLogo?.secureUrl || '../../../assets/images/player-default.png'" alt="Home Team" />
                            <span>{{ match.home }}</span>
                          </div>

                          <div class="vs">
                            <span>{{ match.homeGoals ?? '-' }}</span>
                            VS
                            <span>{{ match.awayGoals ?? '-' }}</span>
                          </div>

                          <div class="team right">
                            <span>{{ match.away }}</span>
                            <img [src]="match?.awayLogo?.secureUrl || '../../../assets/images/player-default.png'" alt="Away Team" />
                          </div>

                          <div class="team-actions">
                            <button class="btn-action btn-edit" (click)="onReport(match)">
                              <i class="fa fa-pencil"></i>
                            </button>
                          </div>
                        </li>
                      </ul>
                    </div>

                    <div class="pagination-wrapper" *ngIf="(myTeam?.rounds?.length || 0) > roundsPerPage">
                      <pagination-controls
                        id="my-team-rounds"
                        (pageChange)="p = $event"
                        previousLabel="Anterior"
                        nextLabel="Siguiente"
                      ></pagination-controls>
                    </div>
                  </div>
                </nz-tab>
              </nz-tabset>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
